# ë¯¼ì§€

## 8.1 ESLintë¥¼ í™œìš©í•œ ì •ì  ì½”ë“œ ë¶„ì„

- ì •ì  ì½”ë“œ ë¶„ì„: ì½”ë“œ ì‹¤í–‰ê³¼ ë³„ê°œë¡œ ì½”ë“œ ê·¸ ìì²´ë¥¼ ë¶„ì„í•´ ë¬¸ì œì˜ ì†Œì§€ê°€ ìˆëŠ” ì½”ë“œë¥¼ ì‚¬ì „ì— ìˆ˜ì •í•˜ëŠ” ê²ƒ
- í”„ë¡œì íŠ¸ì— ì„¤ì¹˜ëœ eslint-configëŠ” ë¬´ì—‡ì´ê³ , ì™œ ì´ê²ƒì„ ë¬¸ì œê°€ ìˆëŠ” ì½”ë“œë¡œ ê°„ì£¼í•˜ëŠ”ì§€ ì‚´í´ë³´ê¸°
- ëª¨ë“  ê·œì¹™ì—ëŠ” ì¡´ì¬ ì´ìœ ê°€ ìˆê¸° ë•Œë¬¸ì— disableì„ ë‚¨ìš©í•˜ì§€ ì•Šê¸°

### 8.1.1 ESLint ì‚´í´ë³´ê¸°

- **ESLintì˜ ë™ì‘ ë°©ì‹**
  1. ìë°”ìŠ¤í¬ë¦½íŠ¸ ì½”ë“œë¥¼ ë¬¸ìì—´ë¡œ ì½ëŠ”ë‹¤.
  2. íŒŒì„œë¡œ ì½”ë“œë¥¼ ìë°”ìŠ¤í¬ë¦½íŠ¸ ì½”ë“œë¥¼ êµ¬ì¡°í™”í•œ AST(Abstract Syntax Tree)ë¥¼ ë§Œë“ ë‹¤.
  3. ì´ êµ¬ì¡°í™”ëœ íŠ¸ë¦¬ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ê°ì¢… ê·œì¹™ê³¼ ëŒ€ì¡°í•œë‹¤.
  4. ê·œì¹™ì„ ìœ„ë°˜í•œ ì½”ë“œë¥¼ ì•Œë¦¬ê±°ë‚˜ ìˆ˜ì •í•œë‹¤.
- ESLintëŠ” ê¸°ë³¸ê°’ìœ¼ë¡œ espreeë¥¼ ì‚¬ìš©í•´ ìë°”ìŠ¤í¬ë¦½íŠ¸ë¥¼ íŒŒì‹±í•˜ì—¬ ASTë¥¼ ë§Œë“ ë‹¤.
  - meta, ê²½ê³  ë¬¸êµ¬ messages, ë¬¸ì„œí™” ì •ë³´ docs, ìˆ˜ì • ê°€ëŠ¥í•œì§€ ì—¬ë¶€ fixable
  - ì‹¤ì œë¡œ ì½”ë“œì—ì„œ ë¬¸ì œì ì„ í™•ì¸í•˜ëŠ” create

### 8.1.2 eslint-pluginê³¼ eslint-config

- eslint-plugin: ESLint ê·œì¹™ì„ ëª¨ì•„ë†“ì€ íŒ¨í‚¤ì§€
  - eslint-plugin-react: jsx key ì—ëŸ¬
- eslint-config: eslint-pluginì„ ë¬¶ì–´ ì—¬ëŸ¬ í”„ë¡œì íŠ¸ì— ë™ì¼í•˜ê²Œ ì ìš©í•  ìˆ˜ ìˆëŠ” ì„¤ì • íŒ¨í‚¤ì§€
  - eslint-config-airbnb
  - @titicaca/triple-config-kit
  - eslint-config-next

### 8.1.3 ë‚˜ë§Œì˜ ESLint ê·œì¹™ ë§Œë“¤ê¸°

- ì´ë¯¸ ì¡´ì¬í•˜ëŠ” ê·œì¹™ ì»¤ìŠ¤í„°ë§ˆì´ì§•

  - ë¦¬ì•¡íŠ¸ 17ë²„ì „ ì´í›„ì—ì„œ `import React from â€˜reactâ€™` ê¸ˆì§€í•˜ê¸°

    ```jsx
    // .eslintrc.js

    module.exports = {
      rules: {
        "no-restricted-imports": [
          "error",
          {
            // pathsì— ê¸ˆì§€ì‹œí‚¬ ëª¨ë“ˆ ì¶”ê°€
            paths: [
              {
                name: "react",
                importNames: ["default"],
                message:
                  "import React from 'react'ëŠ” React 17ë¶€í„° ë” ì´ìƒ í•„ìš”í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. í•„ìš”í•œ ê²ƒë§Œ Reactë¡œë¶€í„° importí•´ì„œ ì‚¬ìš©í•´ ì£¼ì„¸ìš”.",
              },
            ],
          },
        ],
      },
    };
    ```

  - íŠ¸ë¦¬ì‰ì´í‚¹ì´ ë˜ì§€ ì•ŠëŠ” lodash ë¼ì´ë¸ŒëŸ¬ë¦¬ import ë°©ì§€í•˜ê¸°
    ```jsx
    module.exports = {
      rules: {
        "no-restricted-imports": [
          "error",
          {
            // pathsì— ê¸ˆì§€ì‹œí‚¬ ëª¨ë“ˆ ì¶”ê°€
            paths: [
              {
                name: "lodash",
                message:
                  "lodashëŠ” CommonJSë¡œ ì‘ì„±ë¼ ìˆì–´ íŠ¸ë¦¬ì‰ì´í‚¹ì´ ë˜ì§€ ì•Šì•„ ë²ˆë“¤ ì‚¬ì´ì¦ˆë¥¼ í¬ê²Œ í•©ë‹ˆë‹¤. lodash/* í˜•ì‹ìœ¼ë¡œ import í•´ì£¼ì„¸ìš”.",
              },
            ],
          },
        ],
      },
    };
    ```

- ì™„ì „íˆ ìƒˆë¡œìš´ ê·œì¹™ ë§Œë“¤ê¸°

  - ì‚¬ìš© ì¤‘ì¸ ê¸°ê¸°ì— ìƒê´€ì—†ì´ í˜„ì¬ ì‹œê°„ ë°˜í™˜í•˜ë„ë¡ new Date() ì‚¬ìš© ê¸ˆì§€
    ```jsx
    module.exports = {
      meta: {
        type: "suggestion",
        docs: {
          description: "disallow use of the new Date()",
          recommended: false,
        },
      },
      fixable: "code",
      schema: [],
      messages: {
        message:
          "new Date()ëŠ” í´ë¼ì´ì–¸íŠ¸ì—ì„œ ì‹¤í–‰ ì‹œ í•´ë‹¹ ê¸°ê¸°ì˜ ì‹œê°„ì— ì˜ì¡´ì ì´ë¼ ì •í™•í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. í˜„ì¬ ì‹œê°„ì´ í•„ìš”í•˜ë‹¤ë©´ ServerDate()ë¥¼ ì‚¬ìš©í•´ ì£¼ì„¸ìš”.",
      },
      create: function (context) {
        return {
          NewExpression: function (node) {
            if (node.callee.name === "Date" && node.arguments.length === 0) {
              context.report({
                node: node,
                messageId: "message",
                fix: function (fixer) {
                  return fixer.replaceText(node, "ServerDate()");
                },
              });
            }
          },
        };
      },
    };
    ```

- ì£¼ì˜í•  ì 

  - Prettierì™€ ì¶©ëŒ
    - ESLintëŠ” ì½”ë“œì˜ ì ì¬ì ì¸ ë¬¸ì œê°€ ë°œìƒí•˜ëŠ” ë¶€ë¶„ì„ ë¶„ì„, PrettierëŠ” í¬ë§¤íŒ…
    - ì„œë¡œ ê·œì¹™ì´ ì¶©ëŒë˜ì§€ ì•Šê²Œ ê·œì¹™ì„ ì˜ ì„ ì–¸í•˜ê±°ë‚˜
    - JS, TSëŠ” ESLintì—, ê·¸ ì™¸ì˜ íŒŒì¼(md, yaml, json)ì€ Prettierê°€ ë‹´ë‹¹. ìë°”ìŠ¤í¬ë¦½íŠ¸ì— ì¶”ê°€ì ìœ¼ë¡œ í•„ìš”í•œ Prettier ê·œì¹™ì€ `eslint-plugin-prettier` ì‚¬ìš©
  - ê·œì¹™ì— ëŒ€í•œ ì˜ˆì™¸ ì²˜ë¦¬ì™€ `react-hooks/no-exhaustive-deps`

    - eslint-disable

    ```jsx
    // íŠ¹ì • ì¤„ë§Œ ì œì™¸
    // eslint-disable-line no-console

    // ë‹¤ìŒ ì¤„ ì œì™¸
    //eslint-disable-next-line no-console

    // íŠ¹ì • ì—¬ëŸ¬ ì¤„ ì œì™¸
    /* eslint-disable no-console */
    // ... some code
    /* eslint-enable no-console */

    // íŒŒì¼ ì „ì²´ì—ì„œ ì œì™¸
    /* eslint-disable no-console */
    ```

    - eslint-disable-line no-exhaustive-deps
      - useEffectë‚˜ useMemoì™€ ê°™ì€ ì˜ì¡´ ë°°ì—´ì´ í•„ìš”í•œ í›…ì— ì˜ì¡´ì„± ë°°ì—´ì„ ì œëŒ€ë¡œ ì„ ì–¸í–ˆëŠ”ì§€ í™•ì¸
      - ë°œìƒí•  ìˆ˜ ìˆëŠ” ë¬¸ì œ
        - ì‚¬ìš©í•´ë„ ê´œì°®ë‹¤ê³  ì„ì˜ë¡œ íŒë‹¨í•˜ëŠ” ê²½ìš°: í•´ë‹¹ ë³€ìˆ˜ê°€ ì»´í¬ë„ŒíŠ¸ì˜ ìƒíƒœì™€ ë³„ê°œë¡œ ë™ì‘í•œë‹¤ëŠ” ê²ƒì„ ì˜ë¯¸í•˜ë¯€ë¡œ **í•´ë‹¹ ë³€ìˆ˜ë¥¼ ì–´ë””ì—ì„œ ì„ ì–¸í• ì§€ ë‹¤ì‹œ ê³ ë¯¼**
        - ì˜ì¡´ì„± ë°°ì—´ì´ ë„ˆë¬´ ê¸´ ê²½ìš°: **useEffectë¥¼ ìª¼ê°œì„œ** ì˜ì¡´ì„± ë°°ì—´ì˜ ê°€ë…ì„±ê³¼ ì•ˆì •ì„± í™•ë³´
        - ë§ˆìš´íŠ¸ ì‹œì ì— í•œ ë²ˆë§Œ ì‹¤í–‰: ì´ ë°©ë²•ì€ í•¨ìˆ˜í˜• ì»´í¬ë„ŒíŠ¸ì˜ íŒ¨ëŸ¬ë‹¤ì„ê³¼ëŠ” ë§ì§€ ì•Šì„ ê°€ëŠ¥ì„±ì´ ìˆê³ , ì»´í¬ë„ŒíŠ¸ì˜ ìƒíƒœê°’ê³¼ ë³„ê°œë¡œ ë¶€ìˆ˜ íš¨ê³¼ê°€ ë˜ì–´ **ì»´í¬ë„ŒíŠ¸ì˜ ìƒíƒœì™€ ë¶ˆì¼ì¹˜** ë°œìƒ. **ìƒíƒœì™€ ê´€ê³„ ì—†ì´ í•œ ë²ˆë§Œ ì‹¤í–‰**ë¼ì•¼ í•˜ëŠ” ê²ƒì´ ìˆë‹¤ë©´ **í•´ë‹¹ ì»´í¬ë„ŒíŠ¸ì— ì¡´ì¬í•  ì´ìœ ê°€ ì—†ìœ¼ë‹ˆ ì´ë™**ì„ ê³ ë ¤í•´ ë³¼ ê²ƒ.
    - ESLint ë²„ì „ ì¶©ëŒ
      - eslint-config, eslint-pluginì´ ì§€ì›í•˜ëŠ” ESLint ë²„ì „ì„ í™•ì¸
      - ì„¤ì¹˜í•˜ë ¤ëŠ” í”„ë¡œì íŠ¸ì—ì„œ ì‚¬ìš©í•˜ëŠ” ê° íŒ¨í‚¤ì§€ê°€ ESLint ë²„ì „ì„ ì–´ë–»ê²Œ ì§€ì›í•˜ê³  ìˆëŠ”ì§€ í™•ì¸
      - ESLint ê³µì‹ ë¬¸ì„œì—ì„œ ESLint ì˜ì¡´ì„±ì€ peerDependenciesë¡œ ëª…ì‹œí•˜ë„ë¡ ê¶Œì¥í•˜ì§€ë§Œ, ì´ë¥¼ ì¤€ìˆ˜í•˜ì§€ ëª»í•œ íŒ¨í‚¤ì§€ë¥¼ ì„¤ì¹˜í•  ë•Œ ì£¼ì˜

### 8.2 ë¦¬ì•¡íŠ¸ íŒ€ì´ ê¶Œì¥í•˜ëŠ” ë¦¬ì•¡íŠ¸ í…ŒìŠ¤íŠ¸ ë¼ì´ë¸ŒëŸ¬ë¦¬

- í…ŒìŠ¤íŠ¸: ê°œë°œìê°€ ë§Œë“  í”„ë¡œê·¸ë¨ì´ ì½”ë”©ì„ í•œ ì˜ë„ëŒ€ë¡œ ì‘ë™í•˜ëŠ”ì§€ í™•ì¸í•˜ëŠ” ì‘ì—…
- í•„ìš”ì„±
  1. ì„¤ê³„í•œ ëŒ€ë¡œ í”„ë¡œê·¸ë¨ì´ ì‘ë™í•˜ëŠ”ì§€ í™•ì¸
  2. ë²„ê·¸ ì‚¬ì „ ë°©ì§€, ì˜ëª»ëœ ì‘ë™ìœ¼ë¡œ ì¸í•œ ë¹„ìš© ê°ì†Œ
  3. ìˆ˜ì • ë‚´ìš©ì— ëŒ€í•´ ì˜ˆì™¸ ì¼€ì´ìŠ¤ê°€ ì—†ê³  ì˜ë„ëŒ€ë¡œ ë™ì‘í•˜ëŠ”ì§€ í™•ì¸
     â†’ ì‚¬ìš©ìì—ê²Œ ë²„ê·¸ê°€ ìµœì†Œí™”ëœ ì•ˆì •ì ì¸ ì„œë¹„ìŠ¤ë¥¼ ì œê³µ
- í”„ë¡ íŠ¸ì—”ë“œì™€ ë°±ì—”ë“œì˜ í…ŒìŠ¤íŠ¸

  - í”„ë¡ íŠ¸ì—”ë“œ

    - ë¸”ë™ë°•ìŠ¤ í˜•íƒœ: ì½”ë“œê°€ ì–´ë–»ê²Œ ëë“  ìƒê´€ ì—†ì´ **ì˜ë„í•œ ëŒ€ë¡œ ì‘ë™í•˜ëŠ”ì§€ì— ì´ˆì **
    - ì‚¬ìš©ìì—ê²Œ ë…¸ì¶œëœ ì˜ì—­ì´ë¯€ë¡œ ë””ìì¸ ìš”ì†Œ, ì‚¬ìš©ìì˜ ì¸í„°ë™ì…˜, ì˜ë„ì¹˜ ì•Šì€ ì‘ë™ ë“± ë¸Œë¼ìš°ì €ì—ì„œ / ì–´ë–»ê²Œ ì‘ë™í• ì§€ ìµœëŒ€í•œ ì˜ˆì¸¡í•´ì„œ í™•ì¸

  - ë°±ì—”ë“œ
    - í™”ì´íŠ¸ë°•ìŠ¤ í…ŒìŠ¤íŠ¸: ì‘ì„±í•œ ì½”ë“œê°€ ì˜ë„ëŒ€ë¡œ ì‘ë™í•˜ëŠ”ì§€ í™•ì¸. AUI(Application User Interface)ì—ì„œ ìˆ˜í–‰

### 8.2.2 í…ŒìŠ¤íŠ¸

- ë™ì  ì»´í¬ë„ŒíŠ¸

  - `userEvent`
    - @testing-library/reactì—ì„œ ì œê³µí•˜ëŠ” fireEventì˜ ì—¬ëŸ¬ ì´ë²¤íŠ¸ë¥¼ ìˆœì°¨ì ìœ¼ë¡œ ì‹¤í–‰í•´ ìì„¸í•˜ê²Œ ì‚¬ìš©ìì˜ ì‘ë™ì„ í‰ë‚´
    - ì˜ˆë¥¼ ë“¤ì–´, userEvent.clickì„ ì‹¤í–‰í•˜ë©´ ì•„ë˜ì˜ fireEvent ì‹¤í–‰
      ```jsx
      fireEvent.mouseOver;
      fireEvent.mouseMove;
      fireEvent.mouseDown;
      fireEvent.mouseUp;
      fireEvent.click;
      ```
  - `jest.spyOn`: íŠ¹ì • ë©”ì„œë“œë¥¼ ì˜¤ì—¼ì‹œí‚¤ì§€ ì•Šê³  ì‹¤í–‰ ì—¬ë¶€ì™€ ì¸ìˆ˜ ë“±ì˜ ì‹¤í–‰ ì •ë³´ë¥¼ ì–»ê³  ì‹¶ì„ ë•Œ ì‚¬ìš©. ë©”ì„œë“œë¥¼ ê´€ì°°í•˜ëŠ” ì—­í• .

    ```jsx
    const calc = {
      add: (a, b) => a + b,
    };

    const spyFn = jest.spyOn(calc, "add");

    const result = calc.add(1, 2);

    expect(spyFn).toBeCalled(1);
    expect(spyFn).toBeCalledWith(1, 2);
    expect(spyFn).toBe(3);
    ```

  - `mockImplementation`: í•´ë‹¹ ë©”ì„œë“œì— ëŒ€í•œ ëª¨í‚¹ êµ¬í˜„
    - Node.js í™˜ê²½ì— ì—†ëŠ” window.alertì˜ ê²½ìš° ëª¨ì˜ í•¨ìˆ˜ë¡œ êµ¬í˜„

- ë¹„ë™ê¸° ì´ë²¤íŠ¸ê°€ ë°œìƒí•˜ëŠ” ì»´í¬ë„ŒíŠ¸

  - **MSWë¥¼ ì‚¬ìš©í•œ fetch ì‘ë‹µ ëª¨í‚¹, findByë¥¼ í†µí•´ ë¹„ë™ê¸° ìš”ì²­ í›„ ë Œë”ë§ í™•ì¸**
  - MSW(Mock Service Worker)
    - Node.jsë‚˜ ë¸Œë¼ìš°ì €ì—ì„œ ë„¤íŠ¸ì›Œí¬ ìš”ì²­ì„ ìˆ˜í–‰í•˜ê³ , ìš”ì²­ì„ ì¤‘ê°„ì— MSWê°€ ê°ì§€í•˜ê³  ëª¨í‚¹ ë°ì´í„°ë‚˜ ì—ëŸ¬ë¥¼ ë°˜í™˜
  - MSWë¡œ fetch ì‘ë‹µ ëª¨í‚¹

    ```jsx
    import { rest } from 'msw'
    import { setupServeer } from 'msw/node'

    const MOCK_TODO_RESPONSE = {
    	userId: 1,
    	id: 1,
    	title: 'some title',
    	completed: false,
    }

    // ì„œë²„ ë§Œë“¤ê¸°
    const server = setupServer(
    	rest.get('/todos/:id', (req, res, ctx) => {
    		const todoId = req.params.id

    		if (Number(todoId)) {
    			return res(ctx.json({ ...MOCK_TODO_RESPONSE, id: Number(todoId) }))
    		} else {
    			return res(ctx.status(404))
    		}
    	})
    )

    beforeEach(() => server.listen()) // ì„œë²„ ê°€ë™
    afterEach(() => server.resetHandler()) // í•¸ë“¤ëŸ¬ ì´ˆê¸°í™”
    afterAll(() =< server.close()) // ì„œë²„ ì¢…ë£Œ
    ```

    - MSW ì‘ë‹µì´ server.use()ë¡œ ë³€ê²½ë˜ê±°ë‚˜ ì—ëŸ¬ë¥¼ ë˜ì§€ëŠ” ê²½ìš°ì—ë„ server.resetHandler()ë¥¼ í†µí•´ ë§¤ í…ŒìŠ¤íŠ¸ê°€ ëë‚œ ì´í›„ í•¸ë“¤ëŸ¬ ì´ˆê¸°í™”

    ```jsx
    it('ë²„íŠ¼ì„ í´ë¦­í•˜ê³  ì„œë²„ ìš”ì²­ì—ì„œ ì—ëŸ¬ê°€ ë°œìƒí•˜ë©´ ì—ëŸ¬ ë¬¸êµ¬ë¥¼ ë…¸ì¶œí•œë‹¤.', async () => {
    	// ì„œë²„ì—ì„œ ì—ëŸ¬ ë°˜í™˜
    	rest.get('/todos/:id), (req, res, ctx) => {
    		return res(ctx.status(503))
    	}

    	const button = screen.getByRole('button', { name: /1ë²ˆ/ })
    	// ë²„íŠ¼ í´ë¦­
    	fireEvent.click(button)

    	const error = await screen findByText(/ì—ëŸ¬ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤/)
    	// í™”ë©´ì— ì—ëŸ¬ ë‚˜íƒ€ë‚˜ëŠ”ì§€ í™•ì¸
    	expect(error).toBeInTheDocument()
    })
    ```

    - server.use()ë¥¼ í†µí•´ ê¸°ì¡´ setupServerì˜ ë‚´ìš©ì„ ë®ì–´ì“´ë‹¤.

- ì‚¬ìš©ì ì •ì˜ í›…

  - renderHook ì‚¬ìš©

  ```jsx
  import { renderHook } from "@testing-library/react";

  import useEffectDebugger, { CONSOLE_PREFIX } from "./useEffectDebugger";

  const consoleSpy = jest.spyOn(console, "log");
  const componentName = "TestComponent";

  describe("useEffectDebugger", () => {
    afterAll(() => {
      // eslint-disable-next-line @typescript-eslint/ban-ts-comment
      // @ts-ignore

      process.env.NODE_ENV = "development";
    });

    it("ìµœì´ˆì—ëŠ” í˜¸ì¶œë˜ì§€ ì•ŠëŠ”ë‹¤.", () => {
      const props = { hello: "world" };
      // í›… ë Œë”
      renderHook(() => useEffectDebugger(componentName, props));

      expect(consoleSpy).not.toHaveBeenCalled();
    });

    it("propsê°€ ë³€ê²½ë˜ì§€ ì•Šìœ¼ë©´ í˜¸ì¶œë˜ì§€ ì•ŠëŠ”ë‹¤.", () => {
      const props = { hello: "world" };
      const { rerender } = renderHook(() => useEffectDebugger(componentName));

      expect(consoleSpy).not.toHaveBeenCalled();

      rerender();

      expect(consoleSpy).not.toHaveBeenCalled();
    });
  });
  ```

### 8.2.5 í…ŒìŠ¤íŠ¸ ì‘ì„± ì‹œ ê³ ë ¤í•  ê²ƒ

- í…ŒìŠ¤íŠ¸ ì»¤ë²„ë¦¬ì§€ë¥¼ ë§¹ì‹ í•˜ì§€ ë§ê³ , 100%ê¹Œì§€ ëŒì–´ì˜¬ë¦´ ìˆ˜ ìˆëŠ” ìƒí™©ì€ ìƒê°ë³´ë‹¤ ë“œë¬¼ë‹¤.
- ìµœìš°ì„  ê³¼ì œëŠ” **ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ ê°€ì¥ ì·¨ì•½í•˜ê±°ë‚˜ ì¤‘ìš”í•œ ë¶€ë¶„ì„ íŒŒì•…**í•˜ëŠ” ê²ƒ. ì˜ˆë¥¼ ë“¤ì–´, ì „ììƒê±°ë˜ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ë§Œë“ ë‹¤ë©´ ê²°ì œ ë¶€ë¶„.
- í…ŒìŠ¤íŠ¸ ì½”ë“œëŠ” ë°˜ë“œì‹œ ì‚¬ìš©ìì˜ ì‘ì—…ê³¼ ìµœëŒ€í•œ ìœ ì‚¬í•˜ê²Œ ì‘ì„±ë¼ì•¼ í•œë‹¤.
- í…ŒìŠ¤íŠ¸ê°€ ì´ë¤„ì•¼ í•  ëª©í‘œëŠ” **ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ë¹„ì¦ˆë‹ˆìŠ¤ ìš”êµ¬ì‚¬í•­ì„ ì¶©ì¡±í•˜ëŠ”ì§€ í™•ì¸**í•˜ëŠ” ê²ƒ

## ğŸ¤”Â ê³ ë¯¼

### ì–´ë–¤ ìˆœì„œë¡œ, ë¬´ì—‡ì„ í…ŒìŠ¤íŠ¸í• ê¹Œ?

[How to know what to test](https://www.notion.so/How-to-know-what-to-test-69c31ff97b98421e9433f27ab327125e?pvs=21)

- í…ŒìŠ¤íŠ¸ì˜ ëª©ì 
  - **ìœ ì €(ì–´í”Œë¦¬ì¼€ì´ì…˜ ìœ ì €ì™€ ê°œë°œì)ê°€ ì‚¬ìš©í•  ë•Œ ì–´í”Œë¦¬ì¼€ì´ì…˜ì´ ì œëŒ€ë¡œ ë™ì‘**í•  ê²ƒì´ë¼ëŠ” ìì‹ ê°!
  - ìœ ì €ê°€ ì‚¬ìš©í•˜ëŠ” **ìœ ì¦ˆ ì¼€ì´ìŠ¤** ëª¨ë‘ë¥¼ ì½”ë“œê°€ ì§€ì›í•˜ëŠ”ì§€ë¥¼ ìƒê°í•´ë³´ì.
  - ì¦‰, ì½”ë“œ ì»¤ë²„ë¦¬ì§€ ìì²´ë³´ë‹¤ëŠ” **ìœ ì¦ˆ ì¼€ì´ìŠ¤ ì»¤ë²„ë¦¬ì§€**ë¥¼ ìƒê°í•˜ì.
- **Reactì—ëŠ” ì–´ë–»ê²Œ ì ìš©ë ê¹Œ?**
  - ë¼ì´í”„ì‚¬ì´í´ ë©”ì„œë“œ: rerender
    - ê°œë°œìê°€ í•´ë‹¹ ì»´í¬ë„ŒíŠ¸ë¥¼ ìƒˆë¡œìš´ propsë¡œ ë¦¬ë Œë”í•œë‹¤ë©´?
    - ì»´í¬ë„ŒíŠ¸ê°€ ë¦¬ë Œë”ë§í•˜ë„ë¡ ìƒˆë¡œìš´ contextë¥¼ ì œê³µí•œë‹¤ë©´?
  - ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬: userEvent
    - ìœ ì €ê°€ ì»´í¬ë„ŒíŠ¸ê°€ ë Œë”í•˜ëŠ” ìš”ì†Œì™€ ìƒí˜¸ì‘ìš©í•  ìˆ˜ ìˆëŠ”ì§€
  - ì»´í¬ë„ŒíŠ¸ ìƒíƒœ
    - redux store, routerì™€ ê°™ì€ ìƒíƒœê´€ë¦¬ ì €ì¥ì†Œê°€ ë³€ê²½ëœë‹¤ë©´?
- **í° í”„ë¡œì íŠ¸ì— ì–´ë–»ê²Œ ì ìš©í•˜ë©´ ì¢‹ì„ê¹Œ?**
  1. ë¨¼ì € ì–´í”Œë¦¬ì¼€ì´ì…˜ì˜ ê¸°ëŠ¥ì˜ ìš°ì„ ìˆœìœ„ë¥¼ ì •í•œë‹¤. ê¸°ì¤€ì€ â€œì´ ê¸°ëŠ¥ì´ ì œëŒ€ë¡œ ë™ì‘í•˜ì§€ ì•ŠëŠ”ë‹¤ë©´ ìµœì•…ì¼ ê²ƒ ê°™ë‹¤â€ëŠ” ìˆœìœ¼ë¡œ
  2. ì—ëŸ¬ë‚˜ ì˜ˆì™¸ê°€ ë°œìƒí•˜ì§€ ì•ŠëŠ” â€œhappy pathâ€ì— ëŒ€í•œ E2E í…ŒìŠ¤íŠ¸ ì‘ì„±
  3. **ì—£ì§€ ì¼€ì´ìŠ¤**ë‚˜ **ë³µì¡í•œ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§**ì— ëŒ€í•œ **í†µí•© í…ŒìŠ¤íŠ¸ ë° ìœ ë‹› í…ŒìŠ¤íŠ¸** ì‘ì„±

### React Query ì‚¬ìš©í•˜ëŠ” ì»´í¬ë„ŒíŠ¸, ì–´ë–»ê²Œ í…ŒìŠ¤íŠ¸í• ê¹Œ?

[Testing React Query](https://www.notion.so/Testing-React-Query-39d78b9b15c843fb88d4508d4cad8459?pvs=21)

1. useQuery ì»¤ìŠ¤í…€ í›…ì„ mockingí•´ì„œ ê° data fetching state ë³„ë¡œ í™”ë©´ì´ ì˜ ë Œë”ë§ë˜ëŠ”ì§€ í™•ì¸í•˜ëŠ” ìœ ë‹› í…ŒìŠ¤íŠ¸
2. âœ… ë°ì´í„° ë ˆì´ì–´ë¥¼ ì»¤ìŠ¤í…€ í›…ì„ renderHookìœ¼ë¡œ í…ŒìŠ¤íŠ¸í•˜ê³ , í•´ë‹¹ ê²°ê³¼ë¥¼ ë°”íƒ•ìœ¼ë¡œ ì»´í¬ë„ŒíŠ¸ ë Œë”ë¥¼ í™•ì¸í•˜ëŠ” í†µí•© í…ŒìŠ¤íŠ¸

- ì™œ?
  - í…ŒìŠ¤íŠ¸ëŠ” **ìœ ì €ê°€ ì–´í”Œë¦¬ì¼€ì´ì…˜ì„ ì‚¬ìš©í•˜ëŠ” ë°©ì‹ìœ¼ë¡œ ì§„í–‰**ë˜ì–´ì•¼ í•œë‹¤.
  - ì¤‘ìš”í•œ ê²ƒì€ í›…ì˜ ì‹¤í–‰ì´ë‚˜ ë°ì´í„° validationì´ ì˜ ë˜ëŠ”ì§€ê°€ ì•„ë‹ˆë¼, í™”ë©´ì— ì •í™•í•œ ë°ì´í„°ê°€ ë‚˜íƒ€ë‚˜ëŠ”ê°€.
  - ë”°ë¼ì„œ ì»¤ìŠ¤í…€ í›…ì´ ì œëŒ€ë¡œ ëœ ë°ì´í„°ë¥¼ ë°˜í™˜í•˜ëŠ”ì§€ í™•ì¸í•˜ê³ , ì´ë¥¼ ë°”íƒ•ìœ¼ë¡œ í™”ë©´ì— ì œëŒ€ë¡œ ë Œë”ë§ë˜ëŠ”ì§€ë¥¼ í™•ì¸

## ğŸ’« íŠ¸ëŸ¬ë¸”ìŠˆíŒ…

- ì‚¬ìš©í•œ ë²„ì „

  @tanstack/react-query `^4.29.19`

  msw `^2.0.13`

  vite `^5.0.11`

### data fetching í…ŒìŠ¤íŠ¸í•˜ê¸°

1. **ë¡œë”©** ì¤‘ì¸ ê²½ìš°, ë¡œë”© Fallback UI í‘œì‹œ
2. **ì—ëŸ¬ ë°œìƒ**í•œ ê²½ìš°, ì—ëŸ¬ Fallback UI í‘œì‹œ
3. **ë°ì´í„°ê°€ ë¹ˆ ë°°ì—´**ì¸ ê²½ìš°, â€˜No recipe Availableâ€™ í‘œì‹œ
4. **ë°ì´í„°ê°€ ì„±ê³µì **ìœ¼ë¡œ ë“¤ì–´ì˜¨ ê²½ìš°, ìºëŸ¬ì…€ ë° ë ˆì‹œí”¼ ì¹´ë“œ í‘œì‹œ

ğŸ“Œ **React.Suspense** **ë° ErrorBoundary** **ì‚¬ìš©í•˜ê¸°**

ë¼ì´ë¸ŒëŸ¬ë¦¬ Contextë¥¼ ì‚¬ìš©í•˜ê¸° ìœ„í•´ Providerë¥¼ ì„¤ì •í•´ì¤¬ë˜ ê²ƒê³¼ ë§ˆì°¬ê°€ì§€ë¡œ, `**suspense: true**`ë¥¼ ìŠì§€ ë§ê³  ì„¤ì •í•´ì¤„ ê²ƒ.

```jsx
// React-Query ì„¤ì •
const createWrapper = () => {
  const queryClient = new QueryClient({
    defaultOptions: {
      queries: {
        suspense: true, // ì—¬ê¸°
        useErrorBoundary: true,
        retry: false, // ì—ëŸ¬ í…ŒìŠ¤íŠ¸ ìœ„í•´ í•„ìš”
      },
    },
  });

  return function ({ children }: { children: React.ReactNode }) {
    return (
      <RecoilRoot>
        <QueryClientProvider client={queryClient}>
          <Router>{children}</Router>
        </QueryClientProvider>
      </RecoilRoot>
    );
  };
};
```

> **ë°ì´í„° ë ˆì´ì–´ í…ŒìŠ¤íŠ¸**
>
> useQueryë¥¼ ì‚¬ìš©í•˜ëŠ” ì»¤ìŠ¤í…€ í›…ì´ ê° ìƒí™©ì— ë”°ë¼ ì˜ˆì¸¡ëœ ë°ì´í„°ë¥¼ ë°˜í™˜í•˜ëŠ”ì§€ í™•ì¸í•œë‹¤.

```tsx
// useCategorizedRecipes.test.tsx
describe("useCategorizedRecipes", () => {
  const recipeBaseURL = import.meta.env.VITE_EDAMAM_BASE_URL;

  it("successful query hook returns recipe data", async () => {
    const { result } = renderHook(() => useCategorizedRecipes("balanced"));

    await waitFor(() => expect(result.current.isSuccess).toBe(true));
    const { data } = result.current; // ì´ë¯¸ processed ëœ ë°ì´í„°
    const processedRecipes = processRecipesData({ hits });

    expect(data).toMatchObject(processedRecipes);
  });

  it("failure query hook returns error", async () => {
    server.use(
      http.get(recipeBaseURL, async () => {
        return new HttpResponse(null, { status: 404 });
      })
    );

    const { result } = renderHook(() => useCategorizedRecipes("balanced"));

    await waitFor(() => expect(result.current.isError).toBe(true));

    expect(result.current.error).toBeDefined();
    expect(result.current.response.status).toBe(500);
  });
});
```

- result

  useCategorizedRecipesì˜ result ê°ì²´ëŠ” useQueryê°€ ë°˜í™˜í•˜ëŠ” ê°’ê³¼ ê°™ë‹¤.
  ì¦‰, result ê°ì²´ëŠ” í•´ë‹¹ ì»¤ìŠ¤í…€ í›…ì´ ë°˜í™˜í•˜ëŠ” ê°’ì„ ë‹´ê³  ìˆë‹¤. `result.current`ë¡œ ë°˜í™˜ê°’ì„ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.

> **UI ì»´í¬ë„ŒíŠ¸ í…ŒìŠ¤íŠ¸**
>
> í™•ì¸ëœ ë°ì´í„°ë¡œ í•´ë‹¹ ì»¤ìŠ¤í…€ í›…ì„ ì‚¬ìš©í•˜ëŠ” ì»´í¬ë„ŒíŠ¸ê°€ ì˜ˆì¸¡ëœëŒ€ë¡œ UIë¥¼ ë Œë”ë§í•˜ëŠ”ì§€ í™•ì¸í•œë‹¤.

- ë¡œë”© ì¤‘

  ```tsx
  it("displays CarouselSkeleton when recipe data is loading", async () => {
    server.use(
      http.get(recipeBaseURL, async () => {
        await delay();

        return HttpResponse.json({ state: 200 });
      })
    );

    render(
      <Suspense fallback={<CarouselSkeleton category="balanced" />}>
        <Carousel category="balanced" />,
      </Suspense>
    );

    const carouselSkeleton = await screen.findByRole("region", { name: /skeleton/i });
    expect(carouselSkeleton).toBeInTheDocument();
  });
  ```

- ì—ëŸ¬ ë°œìƒ ì‹œ

  ```tsx
  it("displays error message when too many requests", async () => {
    server.use(
      http.get(recipeBaseURL, () => {
        return new HttpResponse(null, { status: 429 });
      })
    );

    render(
      <ErrorBoundary FallbackComponent={ErrorFallback}>
        <Carousel category="balanced" />
      </ErrorBoundary>
    );

    const errorMessage = await screen.findByText("moving super fast!", { exact: false });
    expect(errorMessage).toBeInTheDocument();
  });
  ```

- ë¹ˆ ë°°ì—´ì¸ ê²½ìš°

  ```tsx
  it("displays No Recipe Available when no data", async () => {
    server.use(
      http.get(recipeBaseURL, () => {
        return HttpResponse.json([]);
      })
    );

    render(
      <ErrorBoundary FallbackComponent={ErrorFallback}>
        <Carousel category="balanced" />
      </ErrorBoundary>
    );

    const noRecipeMessage = await screen.findByText("No Recipe Available");
    expect(noRecipeMessage).toBeInTheDocument();
  });
  ```

- ì„±ê³µì ìœ¼ë¡œ ë°ì´í„° ë°›ì€ ê²½ìš°

  ```tsx
  it("displays Carousel with RecipeCards when recipe data is ready", async () => {
    render(<Carousel category="balanced" />);
    const CAROUSEL_DATA_SIZE = 20;

    const carousel = await screen.findByRole("region", { name: /recipes-carousel/i });
    expect(carousel).toBeInTheDocument();

    const recipeCards = await screen.findAllByRole("article");
    expect(recipeCards).toHaveLength(CAROUSEL_DATA_SIZE);
  });
  ```
