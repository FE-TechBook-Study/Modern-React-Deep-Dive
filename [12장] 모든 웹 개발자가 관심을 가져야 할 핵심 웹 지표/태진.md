# 태진

## 모든 웹 개발자가 관심을 가져야 할 핵심 웹 지표

- 많은 개발자들이 성능에 대해 크게 관심을 기울이지 않는 이유

  - 일반적으로 개발자의 기기는 평균적인 기기보다 성능이 뛰어남
  - 성능 개선 작업은 쉽지도, 재밌지도 않고 서비스 개발 작업 대비 눈에 띄는 성능 향상을 기대하기 어려움

- 하지만 웹사이트 성능 또한 개발자의 책임이며, 성능은 조직이 이루고자 하는 목표와 직결된다고 봐도 무방

## 핵심 웹 지표 (Core Web Vital)

- Core Web Vital은 구글에서 정의한 지표
  - 이전에는 뚜렷한 표준이나 측정 방법이 정해져 있지 않았음
  - 이를 해결하기 위해 지표와 측정할 수 있는 방법, 기준을 명확하게 제시함

## LCP (Largest Contentful Paint)

- 페이지가 처음으로 로드를 시작한 시점부터 뷰포트 내부에서 가장 큰 이미지 또는 텍스트를 렌더링하는 데 걸리는 시간
- 뷰포트 내부에서 '큰 이미지와 텍스트'
- DOMContentLoaded 이벤트와는 다름

  - 위 이벤트는 스타일시트, 이미지, 하위 프레임의 로딩은 기다리지 않기 때문

  ### 개선 방안

  - 텍스트를 쓰기
  - 이미지를 불러오는 방법
    - img 태그나 video 태그의 poster 속성이 svg와 css background-image보다 빠름
    - img와 poster 속성은 브라우저의 프리로드 스캐너에 의해서 먼저 발견되어 빠르게 요청이 일어난다
  - 이미지 무손실 압축
  - loading=lazy를 LCP 영역에서 사용하지 말 것
  - 클라이언트에서 빌드하지 말 것
  - LCP 리소스는 직접 호스팅

## FID (First Input Delay)

- 얼마나 빠르게 웹페이지와 상호작용에 대한 응답을 받을 수 있는지
  - 클릭, 터치, 타이핑에 초점을 두고 측정함
- 이벤트 반응은 왜 늦어질까?
  - 브라우저의 메인 스레드가 바쁘기 때문
- 최초 이벤트 발생부터 해당 이벤트의 핸들러가 실행되는 순간까지 사이의 기간만 측정함
  - 이벤트 핸들러가 완료되는 데 걸리는 시간은 Event Timing API를 통해 측정할 수 있음
  - https://www.w3.org/TR/event-timing/

## RAIL

구글은 사용자 경험을 크게 4가지로 분류해 정의함

- Response: 입력에 대한 반응 속도, 50ms
- Animation: 애니메이션의 프레임 속도, 10ms
- Idle: 유휴 시간을 활용해 페이지가 50ms 이내에 사용자 입력에 반응할 수 있도록 함
- Load: 5s 이내에 콘텐츠를 전달하고 인터랙션을 준비

  ### 개선 방안

  - 실행에 오래 걸리는 긴 작업을 분리

    - 꼭 웹페이지에서 해야 하는 작업? -> 서버에 옮겨서 처리
    - 긴 작업을 여러 개로 분리

  - 자바스크립트 코드 최소화

    - 번들링이 되지만, 여전히 사용하지 않는 코드가 존재할 수 있음
    - 크롬 개발자 도구의 커버리지를 활용할 수 있음

  - 타사 자바스크립트 코드 실행의 지연
    - GA, Firebase 등 써드 파티 스크립트
    - script 태그의 async, defer 속성을 이용
      - defer: 다른 리소스와 함께 병렬로 다운로드. 다운로드가 완료됐다 하더라도 페이지가 완전히 로딩된 이후에 맨 마지막에 실행 됨
      - async: 다른 리소스와 함께 병렬로 다운로드. 다운로드가 완료되면 즉시 실행됨
      - 둘 다 없는 경우: script를 만나는 순간 다운로드. 다운로드가 완료되면 코드 실행이 우선됨. 다른 작업은 다운로드와 실행이 끝날 때까지 미뤄짐

## FCP (First Contentful Paint)

- 페이지가 로드되기 시작한 시점부터 페이지 콘텐츠 일부가 화면에 렌더링될 때까지의 시간
